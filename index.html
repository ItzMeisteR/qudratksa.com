<!DOCTYPE html>
<html lang="ar" dir="rtl" class="scroll-smooth">

<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9HLP9MNWS9"></script>
    <script>
        // ====== Admin passphrase unlock (Ctrl+Shift+A) ======
        const ADMIN_PASSPHRASE_KEY = 'qudratksa_admin_pass_hash_v1';
        const ADMIN_SESSION_KEY = 'qudratksa_admin_unlocked_v1';

        async function sha256(text) {
            const enc = new TextEncoder();
            const data = enc.encode(text);
            const hashBuffer = await crypto.subtle.digest('SHA-256', data);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        }

        async function tryRevealAdminWithPrompt() {
            const existing = localStorage.getItem(ADMIN_PASSPHRASE_KEY);
            const pass = prompt('Enter admin passphrase to unlock admin controls (this stores a local hash only).');
            if (!pass) return;
            const h = await sha256(pass);
            if (existing) {
                if (h === existing) {
                    sessionStorage.setItem(ADMIN_SESSION_KEY, '1');
                    revealAdminUI(true);
                    alert('Admin unlocked for this session.');
                } else {
                    alert('Passphrase does not match.');
                }
            } else {
                // first-time: confirm and store hash locally
                const ok = confirm('No local admin passphrase found. Save this passphrase locally (only its hash) so you can unlock later?');
                if (ok) {
                    localStorage.setItem(ADMIN_PASSPHRASE_KEY, h);
                    sessionStorage.setItem(ADMIN_SESSION_KEY, '1');
                    revealAdminUI(true);
                    alert('Passphrase saved locally and admin unlocked for this session.');
                }
            }
        }

        function revealAdminUI(show) {
            document.querySelectorAll('.admin-only').forEach(el => {
                el.style.display = show ? '' : 'none';
            });
        }

        // On load, check session
        if (sessionStorage.getItem(ADMIN_SESSION_KEY) === '1') {
            revealAdminUI(true);
        }

        window.addEventListener('keydown', async (e) => {
            if (e.ctrlKey && e.shiftKey && e.code === 'KeyA') {
                e.preventDefault();
                await tryRevealAdminWithPrompt();
            }
        });

        // ====== Quiz and Summarize handlers ======
        function summarizeText(text, maxSentences = 4) {
            // naive summarization: pick up to N meaningful sentences (Arabic punctuation considered)
            if (!text || !text.trim()) return '';
            const normalized = text.replace(/\s+/g, ' ').trim();
            const parts = normalized.split(/(?<=[.؟!\n])\s+/);
            const sent = parts.map(p => p.trim()).filter(s => s.length > 30);
            const chosen = sent.slice(0, maxSentences);
            let out = chosen.join(' ');
            if (!out && normalized.length > 120) out = normalized.substring(0, 200) + '...';
            return out;
        }

        function generateQuizFromText(text, count = 5) {
            // very naive quiz generation: find declarative sentences and turn into questions
            const sentences = text.replace(/\s+/g, ' ').split(/[.؟!?]+\s+/).filter(s => s.trim().length > 30);
            const out = [];
            for (let i = 0; i < sentences.length && out.length < count; i++) {
                const s = sentences[i].trim();
                // try simple transformations
                if (/\b(هو|هي|هم|تكون|يكون|تساعد|يعمل)\b/.test(s)) {
                    out.push({
                        q: s.replace(/\b(هو|هي|هم|تكون|يكون|تساعد|يعمل)\b/, '؟ ما الذي $&') + '?',
                        a: s
                    });
                } else if (/\b(الـ|ال|في|على|مع)\b/.test(s)) {
                    // make a blank
                    const words = s.split(' ');
                    if (words.length > 6) {
                        const idx = Math.min(3, words.length - 3);
                        const answer = words.slice(idx, idx + 2).join(' ');
                        words.splice(idx, 2, '____');
                        out.push({ q: words.join(' ') + ' ?', a: answer });
                    }
                } else {
                    // fallback: "What is ..." question
                    const short = s.split(' ').slice(0, 8).join(' ');
                    out.push({ q: `ما المقصود بـ: "${short}..."؟`, a: s });
                }
            }
            // pad if necessary
            while (out.length < count) {
                out.push({ q: `سؤال تعبوي ${out.length + 1}`, a: 'إجابة نموذجية' });
            }
            return out;
        }

        // wire buttons
        document.addEventListener('DOMContentLoaded', () => {
            const genBtn = document.getElementById('generate-quiz');
            const sumBtn = document.getElementById('summarize-page');

            genBtn?.addEventListener('click', async () => {
                const pageText = document.body.innerText || document.querySelector('main')?.innerText || '';
                const quiz = generateQuizFromText(pageText, 5);
                let out = 'توليد اختبار من الصفحة:\n\n';
                quiz.forEach((item, idx) => {
                    out += `${idx + 1}. ${item.q}\nالإجابة: ${item.a}\n\n`;
                });
                appendMessage({ role: 'assistant', text: out });
            });

            sumBtn?.addEventListener('click', async () => {
                const pageText = document.body.innerText || document.querySelector('main')?.innerText || '';
                const summary = summarizeText(pageText, 4);
                appendMessage({ role: 'assistant', text: `ملخص الصفحة:\n${summary}` });
            });
        });
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-9HLP9MNWS9');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اختبار القدرات دليلك الشامل عن كيفية الاختبار وأفضل المصادر</title>

    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%232563eb' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A3 3 0 1 0 12 18V5Z'/%3E%3Cpath d='M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A3 3 0 1 1 12 18V5Z'/%3E%3Cpath d='M15 13a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z'/%3E%3Cpath d='M9 13a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z'/%3E%3C/svg%3E">
    <meta name="description" content="كل ما يخص اختبار القدرات العامة من قياس. دليلك لأفضل الدورات ، المصادر، والنماذج المجانية لاختبار القدرات المحوسب والورقي للقسم الكمي واللفظي.">
    <meta name="keywords" content="اختبار القدرات, قدرات, قياس, تجميعات قدرات, قدرات محوسب, قدرات ورقي, نماذج قدرات, شرح قدرات, تسريبات قدرات, القسم الكمي, القسم اللفظي, التناظر اللفظي, الخطأ السياقي, استيعاب المقروء, أفضل كتب القدرات, دورات قدرات, مركز القدرات">
    <meta name="author" content="مركز القدرات الشامل">
    <meta name="robots" content="index, follow">
    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">

        <script src="https://unpkg.com/lucide@latest"></script>

        <style>
                /* Your CSS styles here... */
                body {
                        font-family: 'Cairo', sans-serif;
                }
                .hero-gradient {
                        background: linear-gradient(45deg, rgba(2,0,36,0.9) 0%, rgba(20,9,121,0.85) 35%, rgba(0,188,212,0.8) 100%);
                }
                .section-title {
                        position: relative;
                        padding-bottom: 0.75rem;
                        margin-bottom: 2rem;
                        font-size: 2.25rem;
                        font-weight: 900;
                        color: #1a202c;
                }
                .section-title::after {
                        content: '';
                        position: absolute;
                        bottom: 0;
                        right: 0;
                        width: 80px;
                        height: 4px;
                        background-color: #2563eb;
                        border-radius: 2px;
                }
                .accordion-content {
                        max-height: 0;
                        overflow: hidden;
                        transition: max-height 0.5s ease-in-out, padding 0.5s ease-in-out;
                }
                input:checked ~ .accordion-content {
                        max-height: 1000px;
                        padding-top: 1rem;
                        padding-bottom: 1rem;
                }
                input:checked + label .accordion-icon {
                        transform: rotate(180deg);
                }
                .tab-button {
                        padding: 0.75rem 1.5rem;
                        font-weight: 600;
                        color: #4b5563;
                        border-bottom: 2px solid transparent;
                        transition: all 0.3s;
                        white-space: nowrap;
                }
                .tab-button.active {
                        color: #2563eb;
                        border-bottom-color: #2563eb;
                }
                .filter-button {
                        padding: 0.5rem 1.5rem;
                        font-weight: 700;
                        border-radius: 9999px;
                        background-color: #e5e7eb;
                        color: #374151;
                        transition: all 0.3s ease;
                }
                .filter-button.active {
                         background-color: #2563eb;
                        color: #ffffff;
                        box-shadow: 0 4px 14px 0 rgba(37, 99, 235, 0.3);
                }
                .loader {
                        border: 4px solid rgba(255, 255, 255, 0.3);
                        border-radius: 50%;
                        border-top: 4px solid #ffffff;
                        width: 24px;
                        height: 24px;
                        animation: spin 1s linear infinite;
                }
                @keyframes spin {
                        0% { transform: rotate(0deg); }
                        100% { transform: rotate(360deg); }
                }
        </style>

        <style>
            /* Modern chat styles for AI assistant */
            .chat-card { border-radius: 12px; overflow: hidden; box-shadow: 0 8px 30px rgba(2,6,23,0.08); }
            #chat-messages { padding: 18px; display:flex; flex-direction:column; gap:12px; }
            .msg { max-width: 86%; padding:12px 14px; border-radius:12px; line-height:1.45; word-break:break-word; }
            /* use flex alignment so RTL/LTR behave correctly */
            .msg.user { align-self: flex-end; background:linear-gradient(90deg,#2563eb,#4f46e5); color:white; }
            .msg.assistant { align-self: flex-start; background: white; border:1px solid #e6e6ee; color:#0f172a; }
            .msg .content { white-space: pre-wrap; }
            .msg .sources { font-size:11px; color:#6b7280; margin-top:6px; }
            .loader-dot { width:8px; height:8px; background:#c7d2fe; border-radius:50%; display:inline-block; margin-right:6px; animation: loaderPulse 1s infinite ease-in-out; }
            @keyframes loaderPulse { 0% { transform: scale(1); opacity:1 } 50% { transform: scale(0.7); opacity:0.6 } 100% { transform: scale(1); opacity:1 } }
        </style>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "FAQPage",
            "mainEntity": [
                {
                    "@type": "Question",
                    "name": "كيف أسجل في اختبار القدرات؟",
                    "acceptedAnswer": {
                        "@type": "Answer",
                        "text": "سجل عبر موقع هيئة تقويم التعليم والتدريب (قياس). بعد الدخول، أنشئ حساباً، اختر نوع الاختبار (محوسب أو ورقي)، حدد المدينة والمركز، ثم ادفع الرسوم."
                    }
                },
                {
                    "@type": "Question",
                    "name": "كم رسوم اختبار القدرات؟",
                    "acceptedAnswer": {
                        "@type": "Answer",
                        "text": "رسوم اختبار القدرات المحوسب هي 150 ريال سعودي. أما الورقي، فتكون 100 ريال للتسجيل المبكر و 150 ريال للمتأخر. الأسعار قد تتغير ويجب التأكد من موقع قياس الرسمي."
                    }
                },
                {
                    "@type": "Question",
                    "name": "متى يفتح التسجيل في قدرات محوسب؟",
                    "acceptedAnswer": {
                        "@type": "Answer",
                        "text": "التسجيل في اختبار القدرات المحوسب متاح طوال العام حسب توفر المقاعد في مراكز قياس المعتمدة."
                    }
                },
                {
                    "@type": "Question",
                    "name": "ما هي أفضل التجميعات لاختبار القدرات؟",
                    "acceptedAnswer": {
                        "@type": "Answer",
                        "text": "تعتبر تجميعات المنصف ونماذج المحوسب من المصادر الموثوقة والمهمة للتدريب على أسئلة اختبار القدرات للقسمين الكمي واللفظي. موقعنا يوفر روابط مباشرة لأهمها."
                    }
                },
                {
                    "@type": "Question",
                    "name": "هل اختبار القدرات صعب؟",
                    "acceptedAnswer": {
                        "@type": "Answer",
                        "text": "صعوبة اختبار القدرات نسبية وتعتمد على مدى استعداد الطالب. مع التأسيس الجيد والتدريب على نماذج وتجميعات الاختبار، يمكن تحقيق درجة عالية. موقعنا يوفر لك خطة متكاملة للبدء."
                    }
                },
                {
                    "@type": "Question",
                    "name": "ماذا أحضر معي يوم اختبار القدرات؟",
                    "acceptedAnswer": {
                        "@type": "Answer",
                        "text": "يجب إحضار أصل الهوية الوطنية أو جواز السفر. يتم توفير كل ما تحتاجه في قاعة الاختبار مثل الأقلام والمسودات."
                    }
                }
            ]
        }
        </script>
        <!-- Canonical URL -->
        <link rel="canonical" href="https://qudratksa.com/" />
        <!-- Open Graph Meta Tags -->
        <meta property="og:title" content="اختبار القدرات دليلك الشامل عن كيفية الاختبار وأفضل المصادر" />
        <meta property="og:description" content="كل ما يخص اختبار القدرات العامة من قياس. دليلك لأفضل الدورات ، المصادر، والنماذج المجانية لاختبار القدرات المحوسب والورقي للقسم الكمي واللفظي." />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://qudratksa.com/" />
        <meta property="og:image" content="https://qudratksa.com/20250921_1447_شعار مركز القدرات_simple_compose_01k5p1gcm3evssqpkzegz3hhkh.png" />
        <!-- Twitter Card Meta Tags -->
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:title" content="اختبار القدرات دليلك الشامل عن كيفية الاختبار وأفضل المصادر" />
        <meta name="twitter:description" content="كل ما يخص اختبار القدرات العامة من قياس. دليلك لأفضل الدورات ، المصادر، والنماذج المجانية لاختبار القدرات المحوسب والورقي للقسم الكمي واللفظي." />
        <meta name="twitter:image" content="https://qudratksa.com/20250921_1447_شعار مركز القدرات_simple_compose_01k5p1gcm3evssqpkzegz3hhkh.png" />
        </head>

<body class="bg-gray-50 text-gray-800">

    <header class="bg-white shadow-md sticky top-0 z-50">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-4 space-x-reverse">
                <i data-lucide="brain-circuit" class="text-blue-600 w-8 h-8" alt="شعار مركز القدرات"></i>
                <a href="#" class="text-2xl font-bold text-gray-800">مركز القدرات</a>
            </div>
            <div class="hidden lg:flex items-center space-x-6 space-x-reverse text-sm">
                <a href="#basics" class="flex items-center gap-2 text-gray-600 hover:text-blue-600 transition-colors duration-300"><i data-lucide="graduation-cap" class="w-4 h-4" alt="أيقونة الأساسيات"></i><span>الأساسيات</span></a>
                <a href="#grades" class="flex items-center gap-2 text-gray-600 hover:text-blue-600 transition-colors duration-300"><i data-lucide="bar-chart-3" class="w-4 h-4" alt="أيقونة الدرجات"></i><span>الدرجات</span></a>
                <a href="#resources" class="flex items-center gap-2 text-gray-600 hover:text-blue-600 transition-colors duration-300"><i data-lucide="book-marked" class="w-4 h-4" alt="أيقونة المصادر"></i><span>المصادر</span></a>
                <a href="#planning" class="flex items-center gap-2 text-gray-600 hover:text-blue-600 transition-colors duration-300"><i data-lucide="calendar-check" class="w-4 h-4" alt="أيقونة الخطط"></i><span>الخطط</span></a>
                <a href="#faq" class="flex items-center gap-2 text-gray-600 hover:text-blue-600 transition-colors duration-300">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4" aria-hidden="true"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path><path d="M9.09 9a3 3 0 1 1 5.82 0c0 1.657-3 2.5-3 4" /></svg>
                    <span>الأسئلة الشائعة</span>
                </a>
                <a href="#ai-assistant" class="flex items-center gap-2 text-blue-600 font-bold hover:text-blue-700 transition-colors duration-300"><i data-lucide="sparkles" class="w-4 h-4" alt="أيقونة مساعدك الذكي"></i><span>مساعدك الذكي</span></a>
            </div>
            <button id="mobile-menu-button" class="lg:hidden">
                <i data-lucide="menu" class="w-6 h-6"></i>
            </button>
        </nav>
        <div id="mobile-menu" class="hidden lg:hidden bg-white py-4">
            <a href="#basics" class="flex items-center justify-center gap-2 py-2 px-4 text-gray-600 hover:bg-blue-50"><i data-lucide="graduation-cap" class="w-5 h-5" alt="أيقونة الأساسيات"></i><span>الأساسيات</span></a>
            <a href="#grades" class="flex items-center justify-center gap-2 py-2 px-4 text-gray-600 hover:bg-blue-50"><i data-lucide="bar-chart-3" class="w-5 h-5" alt="أيقونة الدرجات"></i><span>الدرجات والنسبة</span></a>
            <a href="#calculator-tool" class="flex items-center justify-center gap-2 py-2 px-4 text-green-600 font-bold hover:bg-green-50"><i data-lucide="crown" class="w-5 h-5 text-yellow-500"></i><span>حساب الموزونة</span></a>
            <a href="#resources" class="flex items-center justify-center gap-2 py-2 px-4 text-gray-600 hover:bg-blue-50"><i data-lucide="book-marked" class="w-5 h-5" alt="أيقونة المصادر"></i><span>أفضل المصادر</span></a>
            <a href="#planning" class="flex items-center justify-center gap-2 py-2 px-4 text-gray-600 hover:bg-blue-50"><i data-lucide="calendar-check" class="w-5 h-5" alt="أيقونة الخطط"></i><span>خطط المذاكرة</span></a>
            <a href="#faq" class="flex items-center justify-center gap-2 py-2 px-4 text-gray-600 hover:bg-blue-50">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5" aria-hidden="true"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path><path d="M9.09 9a3 3 0 1 1 5.82 0c0 1.657-3 2.5-3 4" /></svg>
                <span>الأسئلة الشائعة</span>
            </a>
            <a href="#ai-assistant" class="flex items-center justify-center gap-2 py-2 px-4 text-blue-600 font-bold hover:bg-blue-50"><i data-lucide="sparkles" class="w-5 h-5" alt="أيقونة مساعدك الذكي"></i><span>مساعدك الذكي</span></a>
        </div>
    </header>
    <main>
        <section class="relative h-[60vh] md:h-[80vh] flex items-center justify-center text-white text-center px-4" style="background-image: url('https://images.unsplash.com/photo-1523050854058-8df90110c9f1?q=80&w=2070&auto=format&fit=crop'); background-size: cover; background-position: center;">
            <div class="absolute inset-0 hero-gradient"></div>
            <div class="relative z-10">
                <h1 class="text-4xl md:text-6xl font-black mb-4 drop-shadow-lg">كل ما تحتاجه عن اختبار القدرات في مكان واحد</h1>
                <p class="text-lg md:text-2xl mb-8 max-w-3xl mx-auto drop-shadow-md">دليلك الشامل لأفضل التجميعات، المصادر، وخطط المذاكرة لاختبار القدرات العامة من قياس.</p>
                <a href="#basics" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-full text-lg transition-transform transform hover:scale-105 duration-300">
                    ابدأ رحلتك الآن
                </a>
            </div>
        </section>
        <section id="basics" class="py-20 bg-white">
            <div class="container mx-auto px-6">
                <h2 class="section-title">
                    <div class="flex items-center gap-4">
                        <i data-lucide="graduation-cap" class="w-10 h-10 text-blue-600" alt="أيقونة الأساسيات"></i>
                        <span>أساسيات اختبار القدرات</span>
                    </div>
                </h2>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="bg-gray-50 p-6 rounded-lg shadow-sm"><div class="flex items-center mb-4"><div class="bg-blue-100 p-3 rounded-full mr-4 ml-0"><i data-lucide="help-circle" class="w-6 h-6 text-blue-600"></i></div><h3 class="text-xl font-bold">ما هو اختبار القدرات؟</h3></div><p>هو اختبار موحد من مركز قياس يقيس القدرة التحليلية والاستدلالية، ويعد شرطًا أساسيًا للقبول في الجامعات السعودية ويدخل ضمن النسبة الموزونة.</p></div>
                    <div class="bg-gray-50 p-6 rounded-lg shadow-sm"><div class="flex items-center mb-4"><div class="bg-blue-100 p-3 rounded-full mr-4 ml-0"><i data-lucide="repeat" class="w-6 h-6 text-blue-600"></i></div><h3 class="text-xl font-bold">كم عدد المحاولات؟</h3></div><p>لكل طالب 5 محاولات بحد أقصى. يمكنك توزيعها بين اختبار القدرات الورقي (فرصتان) والمحوسب.</p></div>
                    <div class="bg-gray-50 p-6 rounded-lg shadow-sm"><div class="flex items-center mb-4"><div class="bg-blue-100 p-3 rounded-full mr-4 ml-0"><i data-lucide="calendar-clock" class="w-6 h-6 text-blue-600"></i></div><h3 class="text-xl font-bold">متى تبدأ التحضير؟</h3></div><p>يُنصح بالبدء في التأسيس من الصف الأول الثانوي، أما التحضير المكثف فيكون قبل الاختبار بشهرين إلى 3 أشهر لضمان أفضل نتيجة.</p></div>
                </div>
                
                <div class="mt-12 bg-gray-50 p-6 rounded-lg shadow-sm">
                    <div class="flex items-center mb-4"><div class="bg-blue-100 p-3 rounded-full mr-4 ml-0"><i data-lucide="layout-list" class="w-6 h-6 text-blue-600"></i></div><h3 class="text-xl font-bold">ما هي أقسام اختبار القدرات؟</h3></div>
                    <div class="grid md:grid-cols-2 gap-x-8 gap-y-4">
                        <div><h4 class="font-semibold">🔹 القسم اللفظي:</h4><p class="pr-6">استيعاب المقروء، التناظر اللفظي، إكمال الجمل، والخطأ السياقي.</p></div>
                        <div><h4 class="font-semibold">🔹 القسم الكمي:</h4><p class="pr-6">يشمل أسئلة الحساب، الهندسة، الجبر، والإحصاء والاحتمالات.</p></div>
                    </div>
                </div>

                <div class="mt-16"><h3 class="text-3xl font-bold text-center mb-2">أيهما أفضل: قدرات ورقي أم محوسب؟</h3><p class="text-center text-gray-600 mb-8 max-w-2xl mx-auto">لا يوجد اختبار "أسهل" من الآخر، فمستوى الصعوبة موحد. لكن طبيعة كل اختبار مختلفة، والخيار الأفضل يعتمد على ما يناسبك شخصياً.</p><div class="grid md:grid-cols-2 gap-8"><div class="border-2 border-blue-500 rounded-lg p-6 bg-blue-50"><div class="flex items-center mb-4"><i data-lucide="monitor" class="w-8 h-8 text-blue-600 ml-3" alt="أيقونة اختبار القدرات المحوسب"></i><h4 class="text-2xl font-bold">اختبار القدرات المحوسب</h4></div><ul class="space-y-3 text-gray-700"><li class="flex items-start"><i data-lucide="check-circle-2" class="w-5 h-5 text-green-500 ml-2 mt-1 shrink-0"></i> <strong class="ml-2">مرونة المواعيد:</strong>متاح على مدار العام.</li><li class="flex items-start"><i data-lucide="check-circle-2" class="w-5 h-5 text-green-500 ml-2 mt-1 shrink-0"></i> <strong class="ml-2">نتائج سريعة:</strong> تظهر خلال 3 إلى 5 أيام عمل.</li><li class="flex items-start"><i data-lucide="check-circle-2" class="w-5 h-5 text-green-500 ml-2 mt-1 shrink-0"></i> <strong class="ml-2">بيئة هادئة:</strong>يُعقد في مقرات مجهزة وهادئة.</li><li class="flex items-start"><i data-lucide="check-circle-2" class="w-5 h-5 text-green-500 ml-2 mt-1 shrink-0"></i> <strong class="ml-2">نماذج ثابتة لفترة:</strong> تتكرر نفس النماذج والأسئلة لفترة معينة (قد تكون شهرًا) ثم تتغير.</li></ul><div class="mt-6 bg-blue-100 p-4 rounded-md"><p class="font-bold text-blue-800">توصية: الخيار الأفضل والأكثر عملية لأكثر من 95% من الطلاب اليوم.</p></div></div><div class="border rounded-lg p-6 bg-white"><div class="flex items-center mb-4"><i data-lucide="clipboard-list" class="w-8 h-8 text-gray-600 ml-3" alt="أيقونة اختبار القدرات الورقي"></i><h4 class="text-2xl font-bold">اختبار القدرات الورقي</h4></div><ul class="space-y-3 text-gray-700"><li class="flex items-start"><i data-lucide="calendar-days" class="w-5 h-5 text-blue-500 ml-2 mt-1 shrink-0"></i> <strong class="ml-2">مواعيد محدودة:</strong>يُعقد في فترات محددة خلال السنة.</li><li class="flex items-start"><i data-lucide="clock" class="w-5 h-5 text-blue-500 ml-2 mt-1 shrink-0"></i> <strong class="ml-2">النتائج:</strong>تستغرق حوالي شهر للظهور.</li><li class="flex items-start"><i data-lucide="users" class="w-5 h-5 text-blue-500 ml-2 mt-1 shrink-0"></i> <strong class="ml-2">بيئة تقليدية:</strong>يُعقد في قاعات دراسية كبيرة.</li><li class="flex items-start"><i data-lucide="edit-3" class="w-5 h-5 text-blue-500 ml-2 mt-1 shrink-0"></i> <strong class="ml-2">تظليل الإجابات:</strong>تعتمد على ورقة الإجابة والتظليل.</li></ul><div class="mt-6 bg-gray-100 p-4 rounded-md"><p class="font-bold text-gray-800">توصية: خيار جيد لمن يرغب في تجربة الاختبار بأسلوب تقليدي، أو كفرصة إضافية لمن استنفد فرص المحوسب.</p></div></div></div>
            </div>
        </section>
        <section id="grades" class="py-20 bg-white">
            <div class="container mx-auto px-6">
                 <h2 class="section-title">
                    <div class="flex items-center gap-4">
                        <i data-lucide="bar-chart-3" class="w-10 h-10 text-blue-600" alt="أيقونة الدرجات"></i>
                        <span>الدرجات ومتطلبات الجامعات</span>
                    </div>
                </h2>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="bg-white p-6 rounded-lg shadow-sm"><h3 class="text-xl font-bold mb-3">كيف يتم حساب الدرجة؟</h3><p>الدرجة معيارية وصالحة لمدة 5 سنوات. للمسارات العلمية، الدرجة موزعة 50% للكمي و 50% للفظي. أما للمسارات الأدبية والإدارية، فيكون اللفظي 70% والكمي 30%.</p></div>
                    <div class="bg-white p-6 rounded-lg shadow-sm"><h3 class="text-xl font-bold mb-3">ما هي الدرجة الجيدة؟</h3><ul class="space-y-1"><li><strong>+90:</strong> درجة ممتازة تضعك ضمن أعلى 5% من الطلاب.</li><li><strong>81-89:</strong> درجة عالية جدًا تؤهلك للتخصصات التنافسية.</li></ul><p class="mt-4 font-bold text-blue-600 border-r-4 border-blue-500 pr-3">هدف كل طالب يجب أن يكون فوق 90 ليضمن القبول في أقوى التخصصات.</p></div>
                    <div class="bg-white p-6 rounded-lg shadow-sm"><h3 class="text-xl font-bold mb-3">متى تظهر نتائج القدرات؟</h3><p><strong>المحوسب:</strong> تظهر النتائج عادةً خلال يومين إلى 5 أيام عمل، وقد تمتد إلى أسبوعين. <br><strong>الورقي:</strong> تستغرق النتائج حوالي شهر للظهور.</p></div>
                </div>
                <div id="calculator-tool" class="grid lg:grid-cols-2 gap-8 mt-12 scroll-mt-24">
                    <div class="bg-blue-50 border-r-4 border-blue-500 p-6 rounded-lg">
                        <h3 class="text-xl font-bold mb-3">كم النسبة الموزونة المطلوبة للجامعات؟</h3>
                        <p class="mb-4">هذه أرقام <strong>تقريبية وتتغير سنوياً</strong>. تحقق دائماً من المواقع الرسمية للجامعات:</p>
                        <ul class="list-disc pr-6 space-y-2">
                            <li><strong>المسارات الصحية والهندسية (جامعات كبرى):</strong> 85 - 95+</li>
                            <li><strong>التخصصات العلمية والإدارية:</strong> 75 - 85+</li>
                            <li><strong>الجامعات الأهلية:</strong> 65 - 80+</li>
                        </ul>
                    </div>
                    <div class="bg-green-50 border-r-4 border-green-500 p-6 rounded-lg">
                        <h3 class="text-xl font-bold mb-3">أداة حساب النسبة الموزونة</h3>
                        <p class="mb-4 text-sm">أدخل نسب جامعتك ودرجاتك لحساب موزونتك فوراً بدقة.</p>

                        <div id="calculator-form" class="space-y-4">
                            <div class="grid grid-cols-3 gap-2 sm:gap-4 font-bold text-center text-xs sm:text-base">
                                <span>المكون</span>
                                <span>النسبة (%)</span>
                                <span>الدرجة</span>
                            </div>

                            <div class="grid grid-cols-3 gap-2 sm:gap-4 items-center">
                                <label for="hs-score" class="font-semibold text-sm sm:text-base">الثانوية</label>
                                <input type="number" id="hs-percent" value="30" class="w-full p-2 text-center border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500" oninput="calculateWeightedScore()">
                                <input type="number" id="hs-score" placeholder="98.5" class="w-full p-2 text-center border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500" oninput="calculateWeightedScore()">
                            </div>

                            <div class="grid grid-cols-3 gap-2 sm:gap-4 items-center">
                                <label for="qu-score" class="font-semibold text-sm sm:text-base">القدرات</label>
                                <input type="number" id="qu-percent" value="30" class="w-full p-2 text-center border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500" oninput="calculateWeightedScore()">
                                <input type="number" id="qu-score" placeholder="88" class="w-full p-2 text-center border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500" oninput="calculateWeightedScore()">
                            </div>

                            <div class="grid grid-cols-3 gap-2 sm:gap-4 items-center">
                                <label for="ta-score" class="font-semibold text-sm sm:text-base">التحصيلي</label>
                                <input type="number" id="ta-percent" value="40" class="w-full p-2 text-center border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500" oninput="calculateWeightedScore()">
                                <input type="number" id="ta-score" placeholder="85" class="w-full p-2 text-center border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500" oninput="calculateWeightedScore()">
                            </div>
                            
                            <p id="percent-warning" class="text-red-500 text-sm text-center hidden pt-2">تنبيه: يجب أن يكون مجموع النسب 100%.</p>

                        </div>

                        <div class="mt-6 text-center bg-green-100 p-4 rounded-md">
                            <p class="text-gray-700">النسبة الموزونة النهائية:</p>
                            <p id="result" class="text-3xl font-bold text-green-700">0.00</p>
                        </div>
                         <p class="mt-4 text-xs sm:text-sm font-bold text-center">تذكير: تحقق دائماً من الموقع الرسمي للجامعة لمعرفة النسب الدقيقة.</p>
                    </div>
                </div>
            </div>
        </section>
        <section id="resources" class="py-20 bg-gray-50 scroll-mt-20">
            <div class="container mx-auto px-6">
                <h2 class="section-title">
                    <div class="flex items-center gap-4">
                        <i data-lucide="book-marked" class="w-10 h-10 text-blue-600" alt="أيقونة المصادر"></i>
                        <span>أفضل المصادر والدورات للقدرات</span>
                    </div>
                </h2>
                
                <div class="space-y-16">
                    <div>
                        <h4 class="text-2xl font-bold text-gray-700 text-center flex justify-center items-center gap-3">
                            <i data-lucide="ruler" class="w-7 h-7"></i>
                            <span>مصادر القسم الكمي</span>
                        </h4>
                         <div class="flex justify-center items-center gap-4 my-8 bg-gray-200 p-2 rounded-full max-w-md mx-auto">
                            <button class="filter-button active" onclick="filterResources('all', this)">الكل</button>
                            <button class="filter-button" onclick="filterResources('paid', this)">مصادر مدفوعة</button>
                            <button class="filter-button" onclick="filterResources('free', this)">مصادر مجانية</button>
                        </div>
                        
                        <div id="quantitative-resources-grid" class="grid md:grid-cols-2 gap-8">
                            <div class="resource-card relative bg-white p-6 pt-12 rounded-lg shadow-lg flex flex-col h-full" data-category="paid">
                                <div class="absolute top-0 left-0 bg-blue-600 text-white text-xs font-bold px-3 py-1 rounded-br-lg rounded-tl-lg flex items-center gap-1">
                                    <i data-lucide="dollar-sign" class="w-3 h-3"></i>
                                    <span>مدفوع</span>
                                </div>
                                <span class="bg-indigo-100 text-indigo-800 text-xs font-semibold mb-3 px-2.5 py-0.5 rounded-full self-start">تأسيس</span>
                                <h6 class="font-bold text-xl mb-2">كتاب المعاصر 10 (للكمي)</h6>
                                <div class="flex items-center mb-3">
                                    <i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-yellow-400"></i><i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-yellow-400"></i><i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-yellow-400"></i><i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-yellow-400"></i><i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-yellow-400"></i>
                                </div>
                                <p class="text-gray-600 mb-4 flex-grow">يعتبر هذا الكتاب أفضل كتب القدرات للتأسيس في القسم الكمي. شرحه المبسط والوافي يجعله الخيار الأمثل للانطلاق نحو درجة +95.</p>
                                <p class="font-semibold mb-4">السعر: 120 ريال سعودي.</p>
                                <div class="mt-auto grid grid-cols-2 gap-2">
                                    <a href="https://www.jarir.com/arabic-books-665503.html?country=sa" target="_blank" rel="noopener noreferrer" class="text-center w-full bg-blue-600 text-white font-bold py-2 px-3 rounded-lg hover:bg-blue-700 transition-colors duration-300 text-sm">شراء من جرير</a>
                                    <a href="https://amzn.eu/d/d3Ngszs" target="_blank" rel="noopener noreferrer" class="text-center w-full bg-orange-500 text-white font-bold py-2 px-3 rounded-lg hover:bg-orange-600 transition-colors duration-300 text-sm">شراء من أمازون</a>
                                </div>
                            </div>
                            <div class="resource-card relative bg-white p-6 pt-12 rounded-lg shadow-lg flex flex-col h-full" data-category="paid">
                                <div class="absolute top-0 left-0 bg-blue-600 text-white text-xs font-bold px-3 py-1 rounded-br-lg rounded-tl-lg flex items-center gap-1">
                                    <i data-lucide="dollar-sign" class="w-3 h-3"></i>
                                    <span>مدفوع</span>
                                </div>
                                <span class="bg-purple-100 text-purple-800 text-xs font-semibold mb-3 px-2.5 py-0.5 rounded-full self-start">تدريب</span>
                                <h6 class="font-bold text-xl mb-2">دورة المنصف الشاملة</h6>
                                <div class="flex items-center mb-3">
                                    <i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-yellow-400"></i><i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-yellow-400"></i><i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-yellow-400"></i><i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-yellow-400"></i><i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-yellow-400"></i>
                                </div>
                                <p class="text-gray-600 mb-4 flex-grow">من أقوى دورات القدرات للتدريب على نماذج المحوسب الحديثة. تتميز بشموليتها وتحديثاتها المستمرة، وهي الخيار الأول للمتفوقين.</p>
                                <p class="font-semibold mb-4">السعر: 199 ريال سعودي.</p>
                                <a href="https://elmonsf.com/Category/1" target="_blank" rel="noopener noreferrer" class="mt-auto text-center w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors duration-300">رابط الدورة</a>
                            </div>
                             <div class="resource-card relative bg-gray-50 p-6 pt-12 rounded-lg shadow-lg flex flex-col h-full" data-category="free">
                                <div class="absolute top-0 left-0 bg-green-600 text-white text-xs font-bold px-3 py-1 rounded-br-lg rounded-tl-lg flex items-center gap-1">
                                    <i data-lucide="gift" class="w-3 h-3"></i>
                                    <span>مجاني</span>
                                </div>
                                <span class="bg-indigo-100 text-indigo-800 text-xs font-semibold mb-3 px-2.5 py-0.5 rounded-full self-start">تأسيس</span>
                                <h6 class="font-bold text-xl mb-2">شروحات تأسيس أينشتاين</h6>
                                 <div class="flex items-center mb-3">
                                    <i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-yellow-400"></i><i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-yellow-400"></i><i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-yellow-400"></i><i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-yellow-400"></i><i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-yellow-400"></i>
                                </div>
                                <p class="text-gray-600 mb-4 flex-grow">كنز مجاني حقيقي! يقدم "أينشتاين" شرح قدرات استثنائي يفكك أعقد مفاهيم الكمي ويجعلها سهلة الفهم للجميع.</p>
                                <a href="https://youtube.com/playlist?list=PLbUZIC2wgSbC0FpJ0mVh2Ar-FHZpq0PKr&si=ZRX3iSYi_wZYTchZ" target="_blank" rel="noopener noreferrer" class="mt-auto text-center w-full bg-green-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-green-700 transition-colors duration-300">رابط يوتيوب مقاطع الشرح</a>
                            </div>
                             <div class="resource-card relative bg-gray-50 p-6 pt-12 rounded-lg shadow-lg flex flex-col h-full" data-category="free">
                                <div class="absolute top-0 left-0 bg-green-600 text-white text-xs font-bold px-3 py-1 rounded-br-lg rounded-tl-lg flex items-center gap-1">
                                    <i data-lucide="gift" class="w-3 h-3"></i>
                                    <span>مجاني</span>
                                </div>
                                <span class="bg-purple-100 text-purple-800 text-xs font-semibold mb-3 px-2.5 py-0.5 rounded-full self-start">تدريب</span>
                                <h6 class="font-bold text-xl mb-2">تجميعات المنصف 1500 سؤال</h6>
                                 <div class="flex items-center mb-3">
                                    <i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-yellow-400"></i><i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-yellow-400"></i><i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-yellow-400"></i><i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-yellow-400"></i><i data-lucide="star" class="w-4 h-4 text-yellow-400 fill-yellow-400"></i>
                                </div>
                                <p class="text-gray-600 mb-4 flex-grow">السلاح السري للتدريب! لا يمكن الاستغناء عن حل تجميعات قدرات التي تمنحك تصوراً حقيقياً عن أسئلة الاختبار وتزيد من سرعتك وثقتك.</p>
                                <a href="https://drive.google.com/file/d/1ispc42x082FCEBm0Dn2diJ5qx9sKMpFK/view?usp=drive_link" target="_blank" rel="noopener noreferrer" class="mt-auto text-center w-full bg-green-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-green-700 transition-colors duration-300 flex items-center justify-center gap-2"><i data-lucide="download" class="w-4 h-4"></i><span>تحميل تجميع المحوسب (PDF)</span></a>
                            </div>
                        </div>
                    </div>
                    
                    <hr class="my-16 border-dashed border-gray-300">

                    <div>
                        <h4 class="text-2xl font-bold mb-8 text-gray-700 text-center flex justify-center items-center gap-3">
                            <i data-lucide="book-open" class="w-7 h-7"></i>
                            <span>مصادر القسم اللفظي</span>
                        </h4>
                        <div class="max-w-3xl mx-auto">
                            <div class="bg-white rounded-lg shadow-lg overflow-hidden relative">
                                <div class="absolute top-0 left-0 bg-blue-600 text-white text-xs font-bold px-3 py-1 rounded-br-lg rounded-tl-lg flex items-center gap-1 z-10">
                                    <i data-lucide="dollar-sign" class="w-3 h-3"></i>
                                    <span>مدفوع</span>
                                </div>
                                <div class="p-8 pt-12">
                                    <p class="font-bold text-2xl mb-2">دورة إيهاب عبد العظيم</p>
                                     <div class="flex items-center mb-3">
                                        <i data-lucide="star" class="w-5 h-5 text-yellow-400 fill-yellow-400"></i><i data-lucide="star" class="w-5 h-5 text-yellow-400 fill-yellow-400"></i><i data-lucide="star" class="w-5 h-5 text-yellow-400 fill-yellow-400"></i><i data-lucide="star" class="w-5 h-5 text-yellow-400 fill-yellow-400"></i><i data-lucide="star" class="w-5 h-5 text-yellow-400 fill-yellow-400"></i>
                                    </div>
                                    <p class="text-gray-600 mb-4">لماذا تعتبر هذه أفضل دورة للقسم اللفظي؟ لأنها طريقك المباشر للتفوق. اشتهرت دورة إيهاب عبد العظيم بأن الكثير من أسئلتها تتكرر في الاختبار الفعلي بشكل مطابق تمامًا "نسخ لصق"، وكأنك تدربت على الاختبار نفسه. استثمر في المضمون واستعد بثقة مطلقة.</p>
                                    <p class="font-semibold mb-6">السعر: 154 ريال سعودي.</p>
                                    <a href="https://hadafakvideos.com/" target="_blank" rel="noopener noreferrer" class="text-center w-full inline-block bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors duration-300">رابط الدورة</a>
                                </div>
                                <div class="bg-yellow-50 border-t border-yellow-200 p-6">
                                    <div class="font-bold flex items-center gap-2 text-yellow-800">
                                        <i data-lucide="gift" class="w-5 h-5"></i>
                                        <span>مصدر مجاني</span>
                                    </div>
                                    <p class="mt-2 text-yellow-800">يفتقر اللفظي لمصادر مجانية عالية الجودة، لذا الاستثمار في دورة مدفوعة هو الخيار الأفضل. كتدريب إضافي مجاني، ابحث عن ملفات التجميعات المتداولة للنماذج الحديثة.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section id="planning" class="py-20 bg-white">
            <div class="container mx-auto px-6">
                <h2 class="section-title">
                     <div class="flex items-center gap-4">
                        <i data-lucide="calendar-check" class="w-10 h-10 text-blue-600" alt="أيقونة الخطط"></i>
                        <span>خطط وجداول مذاكرة القدرات</span>
                    </div>
                </h2>
                <div class="max-w-4xl mx-auto bg-white p-8 rounded-lg shadow-md mb-12">
                    <h3 class="text-2xl font-bold mb-4">كيف أضع خطة مذاكرة فعالة؟</h3>
                    <ul class="space-y-3">
                        <li class="flex items-start"><i data-lucide="check-square" class="w-6 h-6 text-blue-600 ml-3 mt-1 shrink-0"></i><div><strong class="font-bold">1. حدد هدفك:</strong> كم باقي على اختبار القدرات؟ وما هو الوقت المتاح لك يوميًا.</div></li>
                        <li class="flex items-start"><i data-lucide="check-square" class="w-6 h-6 text-blue-600 ml-3 mt-1 shrink-0"></i><div><strong class="font-bold">2. وزع الوقت:</strong> القاعدة العامة هي 60% للكمي، 40% للفظي.</div></li>
                        <li class="flex items-start"><i data-lucide="check-square" class="w-6 h-6 text-blue-600 ml-3 mt-1 shrink-0"></i><div><strong class="font-bold">3. اتبع المراحل:</strong> ابدأ بالتأسيس الجيد، ثم استمر بالتدريب المكثف على نماذج المحوسب حتى يوم الاختبار.</div></li>
                    </ul>
                </div>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="bg-white p-6 rounded-lg shadow-sm border-t-4 border-orange-500"><h3 class="text-xl font-bold mb-3">خطة مذاكرة في شهر</h3><p>الأسبوع الأول: تأسيس مكثف جداً للكمي واللفظي. الأسابيع الثلاثة المتبقية: تدريب متواصل ويومي على النماذج والتجميعات، مع مراجعة الأخطاء أولاً بأول.</p></div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border-t-4 border-red-500"><h3 class="text-xl font-bold mb-3">خطة مذاكرة في أسبوعين</h3><p>الأيام الثلاثة الأولى: مراجعة سريعة جداً للأساسيات. باقي الأيام: تدريب يومي مكثف على تجميعات المحوسب الحديثة، مع التركيز على إدارة الوقت.</p></div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border-t-4 border-yellow-500"><h3 class="text-xl font-bold mb-3">اختباري غداً!</h3><p>لا تذاكر شيئاً جديداً. راجع القوانين مراجعة خفيفة، نم 8 ساعات، تناول فطوراً صحياً، واذهب للمركز مبكراً. توكل على الله.</p></div>
                </div>
            </div>
        </section>
        <section id="faq" class="py-20 bg-gray-50">
            <div class="container mx-auto px-6">
                 <h2 class="section-title">
                    <div class="flex items-center gap-4">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" class="w-10 h-10 text-blue-600" aria-hidden="true" role="img"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path><path d="M9.09 9a3 3 0 1 1 5.82 0c0 1.657-3 2.5-3 4" /></svg>
                        <span>الأسئلة الشائعة عن اختبار القدرات</span>
                    </div>
                </h2>
                <div class="max-w-4xl mx-auto">
                    <div class="bg-white rounded-lg shadow-sm mb-4"><input type="checkbox" id="accordion-faq-1" class="hidden"><label for="accordion-faq-1" class="flex justify-between items-center p-5 cursor-pointer font-bold text-lg">كيف أسجل في اختبار القدرات؟<span class="accordion-icon text-blue-500 transition-transform duration-300 transform"><i data-lucide="chevron-down"></i></span></label><div class="accordion-content px-5 text-gray-600"><p>التسجيل يكون عبر موقع هيئة تقويم التعليم والتدريب (قياس) بالضغط على الرابط التالي: <a href="https://e-services.etec.gov.sa/Qiyas.TRAS.Web.Internet/Account/Index" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline font-bold">موقع قياس - تسجيل الدخول</a>. بعد الدخول، أنشئ حساباً، اختر نوع الاختبار، حدد المدينة والمركز، ثم ادفع الرسوم.</p></div></div>
                    <div class="bg-white rounded-lg shadow-sm mb-4"><input type="checkbox" id="accordion-faq-2" class="hidden"><label for="accordion-faq-2" class="flex justify-between items-center p-5 cursor-pointer font-bold text-lg">كم رسوم اختبار القدرات؟<span class="accordion-icon text-blue-500 transition-transform duration-300 transform"><i data-lucide="chevron-down"></i></span></label><div class="accordion-content px-5 text-gray-600"><ul class="list-disc pr-5 space-y-2"><li>اختبار القدرات الورقي: 100 ريال سعودي (تسجيل مبكر)، و 150 ريال سعودي (تسجيل متأخر).</li><li>اختبار القدرات المحوسب: 150 ريال سعودي.</li></ul><div class="mt-4 p-3 bg-yellow-100 border-r-4 border-yellow-400 text-yellow-800 rounded-md"><p><strong>تنبيه مهم:</strong> الرسوم قابلة للتغيير. تحقق دائماً من الموقع الرسمي لهيئة تقويم التعليم والتدريب للحصول على أحدث الأسعار.</p></div></div></div>
                    <div class="bg-white rounded-lg shadow-sm mb-4"><input type="checkbox" id="accordion-faq-3" class="hidden"><label for="accordion-faq-3" class="flex justify-between items-center p-5 cursor-pointer font-bold text-lg">متى تفتح فترات التسجيل؟<span class="accordion-icon text-blue-500 transition-transform duration-300 transform"><i data-lucide="chevron-down"></i></span></label><div class="accordion-content px-5 text-gray-600"><p>التسجيل في اختبار المحوسب متاح طوال العام حسب توفر المقاعد في المراكز. أما الاختبار الورقي، فيُعقد عادةً في فترات محددة تعلن عنها هيئة تقويم التعليم والتدريب.</p></div></div>
                    <div class="bg-white rounded-lg shadow-sm mb-4"><input type="checkbox" id="accordion-faq-4" class="hidden"><label for="accordion-faq-4" class="flex justify-between items-center p-5 cursor-pointer font-bold text-lg">ماذا لو لم أجد مقعداً متاحاً؟<span class="accordion-icon text-blue-500 transition-transform duration-300 transform"><i data-lucide="chevron-down"></i></span></label><div class="accordion-content px-5 text-gray-600"><p>تابع موقع قياس باستمرار، فقد تُفتح مقاعد إضافية نتيجة الإلغاء. جرب البحث في مدن مجاورة. سجل في قائمة الانتظار إن كانت متاحة.</p></div></div>
                    <div class="bg-white rounded-lg shadow-sm mb-4"><input type="checkbox" id="accordion-faq-5" class="hidden"><label for="accordion-faq-5" class="flex justify-between items-center p-5 cursor-pointer font-bold text-lg">هل يمكن تغيير موعد الاختبار؟<span class="accordion-icon text-blue-500 transition-transform duration-300 transform"><i data-lucide="chevron-down"></i></span></label><div class="accordion-content px-5 text-gray-600"><p>نعم، حسب هيئة تقويم التعليم والتدريب، يمكن تعديل موعد الاختبارات المحوسبة قبل 72 ساعة من موعد الاختبار. قد يتم تطبيق رسوم إضافية.</p></div></div>
                    <div class="bg-white rounded-lg shadow-sm mb-4"><input type="checkbox" id="accordion-faq-6" class="hidden"><label for="accordion-faq-6" class="flex justify-between items-center p-5 cursor-pointer font-bold text-lg">ماذا أحضر يوم الاختبار؟<span class="accordion-icon text-blue-500 transition-transform duration-300 transform"><i data-lucide="chevron-down"></i></span></label><div class="accordion-content px-5 text-gray-600"><p><strong>أصل الهوية الوطنية</strong> أو جواز السفر. سيتم توفير مكان مخصص (خزانة) لحفظ أغراضك الشخصية قبل دخول قاعة الاختبار.</p></div></div>
                    <div class="bg-white rounded-lg shadow-sm mb-4"><input type="checkbox" id="accordion-faq-7" class="hidden"><label for="accordion-faq-7" class="flex justify-between items-center p-5 cursor-pointer font-bold text-lg">هل تختلف صعوبة الأسئلة بين المراكز؟<span class="accordion-icon text-blue-500 transition-transform duration-300 transform"><i data-lucide="chevron-down"></i></span></label><div class="accordion-content px-5 text-gray-600"><p>لا، مستوى الصعوبة موحد تماماً بين جميع المراكز والنماذج المختلفة. لكن، الأسئلة نفسها التي تظهر لك تكون عشوائية ومختلفة عن زميلك لضمان العدالة.</p></div></div>
                    <div class="bg-white rounded-lg shadow-sm mb-4">
                        <input type="checkbox" id="accordion-faq-8" class="hidden">
                        <label for="accordion-faq-8" class="flex justify-between items-center p-5 cursor-pointer font-bold text-lg">ما هو نظام نمر الجديد؟
                            <span class="accordion-icon text-blue-500 transition-transform duration-300 transform"><i data-lucide="chevron-down"></i></span>
                        </label>
                        <div class="accordion-content px-5 text-gray-600">
                            <p class="mb-4">
                                هو ليس نظام اختبار جديد، بل مجرد تحديث لطريقة عرض أسئلة اختبار القدرات المحوسب على شاشة الكمبيوتر. يهدف النظام إلى تحسين تجربة المختبرين، ومن أبرز مميزاته الإيجابية هو تسهيل حل قسم استيعاب المقروء بعرض السؤال مع الجزء المتعلق به من النص فقط. لا داعي للقلق فهو لا يؤثر سلباً على أداء الطالب.
                            </p>
                            <button onclick="toggleNimrDetails(this)" class="text-blue-600 font-bold hover:underline mb-4">اقرأ التفاصيل الكاملة <i data-lucide="arrow-down" class="inline-block w-4 h-4 transition-transform"></i></button>
                            <div class="nimr-details hidden space-y-4 pt-4 border-t border-gray-200">
                                <h4 class="font-bold text-base">1- التعريف بنظام نمر:</h4>
                                <p>هو عبارة عن نظام خاص بآلية عرض الاختبار على جهاز الكمبيوتر فقط. وليس نظام جديد بل هو موجود عند قياس منذ فترة، و خلال الفترة الماضية ظهر للمختبرين أثناء اختبارهم لـ القدرات العامة - المحوسب -</p>
                                
                                <h4 class="font-bold text-base">2- خصائص نظام نمر:</h4>
                                <ul class="list-disc pr-5 space-y-2">
                                    <li>الاختبار مكوّن من 5 أقسام، كل قسم يحتوي على أسئلة كمي ولفظي خلال 25 دقيقة.</li>
                                    <li>في كل قسم يبدأ بأسئلة الكمي أولًا ثم اللفظي.</li>
                                    <li>يظهر اسمك ورقم هويتك والوقت المتبقي أعلى يسار الشاشة.</li>
                                    <li>رقم هويتك يكون مكتوباً بلون شفاف على الشاشة كعلامة مائية.</li>
                                    <li><strong>الميزة الأهم:</strong> في قسم استيعاب المقروء، أصبح يظهر السؤال مع الجزء المتعلق به من النص فقط، مما يسهل الحل.</li>
                                </ul>

                                <h4 class="font-bold text-base">3- هل نظام نمر يؤثر على المُختبر سَلبًا؟!</h4>
                                <p>النظام لا يؤثر على المُختبرين بشكل سَلبي أبدًا، بل هو تغيير إيجابي وتحسينات لآلية الاختبار فلا داعي للقلق.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section id="ai-assistant" class="py-20 bg-white">
            <div class="container mx-auto px-6">
                <h2 class="section-title">
                    <div class="flex items-center gap-4">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" class="w-10 h-10 text-blue-600" aria-hidden="true" role="img"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path><path d="M9.09 9a3 3 0 1 1 5.82 0c0 1.657-3 2.5-3 4" /></svg>
                        <span>مساعدك الذكي — دردشة مدعومة بمحتوى الموقع</span>
                    </div>
                </h2>

                <p class="text-center text-gray-600 mb-6 max-w-3xl mx-auto">مساعد ذكي مُعاد تصميمه: يتفحص محتوى الموقع والإجابات التي تضيفها ثم يولّد إجابات ذكية. لمزامنة مع نموذج قوي عبر الإنترنت، قم بتوصيل نقطة نهاية خوادم (لن يتم تضمين أي مفاتيح في الكود).</p>

             <!-- ADMIN NOTES: To enable admin/training controls, edit this file.
                 1) Open this file and locate "ADMIN_ENABLED" (near the AI script). Set it to true.
                 2) Optionally set your secure server endpoint in the ai-endpoint input (or via code) on the server side.
                 3) After editing, deploy the changed file. These controls remain hidden by default so normal visitors only see the simple chat.
             -->
             <div class="max-w-6xl mx-auto bg-white p-6 sm:p-8 rounded-2xl shadow-2xl border border-gray-200">
                    <div class="grid lg:grid-cols-3 gap-6">
                        <div class="lg:col-span-1 p-4 border rounded-lg admin-only" style="display:none">
                            <h3 class="font-bold text-lg mb-3">عن المساعد</h3>
                            <p class="text-sm text-gray-600 mb-4">يجمع المساعد الأدلة من صفحات الموقع والإجابات التي تضيفها. لإجابات أعمق وذكاء محادثي متقدم، اربط خدمة AI آمنة عبر الخادم.</p>
                                <div class="mt-4 space-y-3">
                                <button id="open-training" class="w-full inline-block bg-yellow-400 text-black font-semibold py-2 px-4 rounded-md hover:brightness-95 admin-only" style="display:none">إعداد المساعد</button>
                                <button id="clear-training" class="w-full inline-block bg-red-100 text-red-700 font-semibold py-2 px-4 rounded-md admin-only" style="display:none">مسح البيانات</button>
                                <button id="show-kb" class="w-full inline-block bg-gray-100 text-gray-800 font-semibold py-2 px-4 rounded-md admin-only" style="display:none">عرض/تعديل الإجابات المضافة</button>
                            </div>
                            <div id="ai-settings" class="mt-6 text-sm text-gray-600 admin-only" style="display:none">
                                <label class="font-semibold">نقطة نهاية AI (اختياري)</label>
                                <input id="ai-endpoint" placeholder="https://example.com/api/ai" class="w-full mt-2 p-2 border rounded-md text-sm" />
                                <p class="text-xs text-gray-400 mt-2">أدخل نقطة نهاية الخادم التي تستدعي نموذج LLM بأمان (الخادم يجب أن يحمل مفتاح الـ API).</p>
                                <button id="save-endpoint" class="mt-3 w-full bg-blue-600 text-white py-2 rounded-md">حفظ الإعداد</button>
                            </div>
                        </div>

                        <div class="lg:col-span-2 p-0 rounded-lg overflow-hidden flex flex-col" style="min-height:420px;">
                            <div class="flex items-center justify-between p-4 border-b bg-white">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold">م</div>
                                    <div>
                                        <div class="font-bold">مساعد القدرات</div>
                                        <div class="text-xs text-gray-500">يجيب اعتماداً على محتوى الموقع وبياناتك المضافة</div>
                                    </div>
                                </div>
                                <div class="text-sm text-gray-500">مصدر: الموقع المحلي + KB</div>
                            </div>

                            <div id="chat-messages" class="flex-1 p-4 overflow-auto bg-gray-50 space-y-4">
                                <!-- messages go here -->
                            </div>

                            <div class="p-4 border-t bg-white">
                                    <div class="flex gap-3">
                                        <textarea id="qa-input" rows="2" class="flex-1 p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500" placeholder="اكتب سؤالك هنا... مثال: كيف أراجع قبل الاختبار بأسبوع؟"></textarea>
                                        <div class="flex flex-col gap-2">
                                            <button id="qa-submit" class="bg-blue-600 text-white font-bold py-2 px-4 rounded-md">أرسل</button>
                                            <button id="add-answer" class="bg-green-600 text-white font-bold py-2 px-4 rounded-md admin-only" title="أضف إجابة مخصصة للسؤال الحالي" style="display:none">أضف إجابة</button>
                                        </div>
                                    </div>
                                    <div class="flex gap-3 mt-3">
                                        <button id="generate-quiz" class="bg-indigo-600 text-white py-2 px-3 rounded-md text-sm">توليد اختبار (5 أسئلة)</button>
                                        <button id="summarize-page" class="bg-gray-100 text-gray-800 py-2 px-3 rounded-md text-sm">تلخيص الصفحة</button>
                                    </div>
                                    <div id="chat-sources" class="mt-3 text-xs text-gray-500"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Training modal (hidden) -->
                <div id="training-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
                    <div class="bg-white max-w-3xl w-full p-6 rounded-md shadow-lg mx-4 overflow-auto max-h-[80vh]">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold">نموذج إعداد المساعد — 20 سؤالاً شائعاً</h3>
                            <button id="close-training" class="text-gray-500">إغلاق</button>
                        </div>
                        <form id="training-form" class="space-y-4">
                            <p class="text-sm text-gray-600">أجب عن الأسئلة التالية إن وُجدت لديك إجابات. يمكنك ترك أي خانة فارغة للانتقال لاحقاً.</p>
                            <div id="training-questions" class="grid grid-cols-1 gap-3">
                                <!-- Questions will be injected here -->
                            </div>
                            <div class="flex gap-3 mt-4">
                                <button type="submit" class="bg-blue-600 text-white py-2 px-4 rounded-md">حفظ الإجابات</button>
                                <button id="skip-training" type="button" class="bg-gray-100 text-gray-700 py-2 px-4 rounded-md">تخطي الآن</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </section>
        <section id="motivation" class="py-20 bg-gray-50">
            <div class="container mx-auto px-6">
                <h2 class="section-title">
                     <div class="flex items-center gap-4">
                        <i data-lucide="heart-handshake" class="w-10 h-10 text-blue-600"></i>
                        <span>التحفيز والدعم النفسي</span>
                    </div>
                </h2>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12">
                    <div class="bg-white p-6 rounded-lg shadow-sm"><h3 class="font-bold text-lg mb-2">أشعر بالإحباط واليأس، ماذا أفعل؟</h3><p>تذكر أن هذا الشعور طبيعي. خذ استراحة، تحدث مع شخص تثق به، راجع أهدافك وأحلامك، وأكثر من الدعاء: "اللهم لا سهل إلا ما جعلته سهلاً".</p></div>
                    <div class="bg-white p-6 rounded-lg shadow-sm"><h3 class="font-bold text-lg mb-2">أخاف من الفشل، كيف أتغلب على الخوف؟</h3><p>الاستعداد الجيد هو أفضل علاج للخوف. كلما كنت مستعداً أكثر، زادت ثقتك. ابذل قصارى جهدك ثم توكل على الله. لديك عدة محاولات.</p></div>
                    <div class="bg-white p-6 rounded-lg shadow-sm"><h3 class="font-bold text-lg mb-2">كيف أتعامل مع ضغط الأهل والمجتمع؟</h3><p>تواصل مع أهلك واشرح لهم خطتك وحاجتك للدعم بدلاً من الضغط. ركز على هدفك وتجنب مقارنة نفسك بالآخرين.</p></div>
                </div>
                <div class="mt-12 text-center bg-blue-900 text-white rounded-lg p-8 shadow-xl" role="alert">
                    <div class="flex justify-center items-center mb-4"><i data-lucide="heart" class="w-10 h-10 mr-4 ml-0"></i><p class="font-black text-3xl">رسالة أخيرة لك</p></div>
                    <p class="text-lg">استيقظ مبكراً يوم الاختبار، صلِّ الفجر، تناول فطوراً خفيفاً، واذهب إلى المركز مبكراً. ابذل قصارى جهدك ثم توكل على الله. النتيجة في النهاية بيده سبحانه. نسأل الله لكم كل التوفيق والنجاح.</p>
                </div>
            </div>
        </section>
        </main>

    <footer class="bg-gray-800 text-white py-8">
        <div class="container mx-auto px-6 text-center">
            <p>&copy; 2025 مركز القدرات الشامل. كل الحقوق محفوظة.</p>
            <p class="text-gray-400 text-sm mt-2">تم تصميمه لمساعدة طلاب المملكة على تحقيق أحلامهم.</p>
            <p class="text-gray-400 text-sm mt-2">للتواصل: <a href="mailto:qudratksa2025@gmail.com" class="hover:underline">qudratksa2025@gmail.com</a></p>
            <p class="text-gray-500 text-xs mt-4 max-w-2xl mx-auto">
                <strong>إخلاء مسؤولية:</strong> المعلومات الواردة في هذا الموقع هي لأغراض إرشادية فقط. نسعى جاهدين لدقة المحتوى، ولكن يجب على الطلاب دائمًا التحقق من المعلومات من المصادر الرسمية مثل موقع هيئة تقويم التعليم والتدريب (ETEC) والمواقع الرسمية للجامعات. لا يتحمل الموقع أي مسؤولية عن أي قرارات يتم اتخاذها بناءً على المعلومات المقدمة هنا.
            </p>
        </div>
    </footer>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof lucide !== 'undefined' && lucide.createIcons) lucide.createIcons();

            // Intercept any link that contains a hash (fragment) and convert to path-style /id
            document.querySelectorAll('a[href*="#"]').forEach(link => {
                link.addEventListener('click', function(e) {
                    try {
                        const href = this.getAttribute('href');
                        if (!href || href === '#') return;

                        let fragment = null;
                        if (/^https?:\/\//i.test(href)) {
                            // absolute URL: ensure same site (allow www vs non-www)
                            const parsed = new URL(href, window.location.href);
                            const stripWWW = h => h.replace(/^www\./i, '');
                            if (stripWWW(parsed.hostname) !== stripWWW(window.location.hostname)) return; // external
                            fragment = parsed.hash.replace('#', '').trim();
                        } else {
                            fragment = href.split('#').pop().trim();
                        }
                        if (!fragment) return;
                        const target = document.getElementById(fragment);
                        if (!target) return;
                        e.preventDefault();
                        target.scrollIntoView({ behavior: 'smooth' });
                        // Update URL to /fragment (clear hash)
                        try {
                            const url = new URL(window.location.href);
                            url.pathname = '/' + fragment;
                            url.hash = '';
                            if (history.replaceState) history.replaceState(null, '', url.pathname + url.search);
                        } catch (err) {
                            if (history.replaceState) history.replaceState(null, '', '/' + encodeURIComponent(fragment));
                        }
                    } catch (err) { /* ignore */ }
                });
            });

            // If page opened with a hash (e.g. /#planning), or query (?section=planning), convert/scroll accordingly.
            (function handleInitialHashOrPath() {
                try {
                    // 1) If there's a hash fragment, prefer that
                    if (window.location.hash) {
                        const frag = window.location.hash.replace('#', '').replace(/\/$/, '');
                        if (frag) {
                            const el = document.getElementById(frag);
                            if (el) {
                                try {
                                    const url = new URL(window.location.href);
                                    url.pathname = '/' + frag;
                                    url.hash = '';
                                    if (history.replaceState) history.replaceState(null, '', url.pathname + url.search);
                                } catch (err) {
                                    if (history.replaceState) history.replaceState(null, '', '/' + encodeURIComponent(frag));
                                }
                                setTimeout(() => el.scrollIntoView({ behavior: 'smooth' }), 50);
                                return;
                            }
                        }
                    }

                    // 2) Support query parameter fallback: ?section=<id>
                    try {
                        const params = new URLSearchParams(window.location.search);
                        const section = params.get('section');
                        if (section) {
                            const frag = section.replace(/\/$/, '');
                            const el = document.getElementById(frag);
                            if (el) {
                                setTimeout(() => el.scrollIntoView({ behavior: 'smooth' }), 50);
                                return;
                            }
                        }
                    } catch (err) { /* ignore */ }

                    // 3) If path-style (e.g. /planning) is used and server served index.html, scroll to it
                    const path = window.location.pathname.replace(/^\//, '').replace(/\/$/, '');
                    if (path) {
                        const el = document.getElementById(path);
                        if (el) setTimeout(() => el.scrollIntoView({ behavior: 'smooth' }), 50);
                    }
                } catch (err) { /* ignore */ }
            })();

            // Handle Back/Forward navigation
            window.addEventListener('popstate', () => {
                try {
                    const path = window.location.pathname.replace(/^\//, '').replace(/\/$/, '');
                    if (path) {
                        const el = document.getElementById(path);
                        if (el) el.scrollIntoView({ behavior: 'smooth' });
                    } else {
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    }
                } catch (err) { /* ignore */ }
            });

            // --- AI assistant: Hybrid retrieval + optional remote AI scaffold ---
            try {
                const chatMessages = document.getElementById('chat-messages');
                const qaSubmit = document.getElementById('qa-submit');
                const qaInput = document.getElementById('qa-input');
                const addAnswerBtn = document.getElementById('add-answer');
                const showKbBtn = document.getElementById('show-kb');
                const aiEndpointInput = document.getElementById('ai-endpoint');
                const saveEndpointBtn = document.getElementById('save-endpoint');
                const chatSources = document.getElementById('chat-sources');

                // local storage helpers (KB) - structured entries: { answer: string, keywords: [str] }
                function kbKey() { return 'qudratksa_kb_v1'; }
                function loadKB() {
                    try {
                        const raw = JSON.parse(localStorage.getItem(kbKey()) || '{}');
                        const out = {};
                        for (const k of Object.keys(raw || {})) {
                            const v = raw[k];
                            if (v && typeof v === 'string') {
                                out[k] = { answer: v, keywords: extractKeywordsFromQuestion(k) };
                            } else if (v && v.answer) {
                                out[k] = v;
                            }
                        }
                        return out;
                    } catch (e) { return {}; }
                }
                function saveKB(kb){ localStorage.setItem(kbKey(), JSON.stringify(kb)); }
                function clearKB(){ localStorage.removeItem(kbKey()); }

                // Tokenization & keyword helpers
                function tokenize(text){
                    if (!text) return [];
                    const stop = ['في','من','على','و','ما','هل','كيف','لم','لن','الى','إلى','عن','أن','إن','الذي','التي','هذا','هذه','ذلك','تلك','مع','لـ','لا','يا','بعد','قبل','كما','قد','كل'];
                    const cleaned = text.replace(/[\u064B-\u0652\u061F\u060C\u061B.,!?"'()\[\]«»<>:؛\-\/\\]/g,' ').toLowerCase();
                    return cleaned.split(/\s+/).map(s=>s.trim()).filter(s=>s.length>2 && !stop.includes(s));
                }

                function extractKeywordsFromQuestion(q){
                    const toks = tokenize(q || '');
                    const uniq = [...new Set(toks)];
                    return uniq.slice(0,6);
                }

                // fuzzy KB match based on keyword overlap
                function findBestKBMatch(question){
                    const kb = loadKB();
                    const qKeys = extractKeywordsFromQuestion(question);
                    if (!qKeys.length) return null;
                    let best = null; let bestScore = 0;
                    for (const k of Object.keys(kb)){
                        try{
                            const entry = kb[k];
                            const entryKeys = entry.keywords || extractKeywordsFromQuestion(k);
                            const common = entryKeys.filter(x=>qKeys.includes(x)).length;
                            const denom = Math.max(1, Math.round((entryKeys.length + qKeys.length)/2));
                            const score = common/denom;
                            if (score > bestScore){ bestScore = score; best = {question: k, entry, score}; }
                        }catch(e){}
                    }
                    if (best && (best.score >= 0.3 || question.replace(/\s+/g,'').toLowerCase().includes(best.question.replace(/\s+/g,'').toLowerCase()))) return best;
                    return null;
                }

                // endpoint persistence (client-side only)
                const endpointKey = 'qudratksa_ai_endpoint_v1';
                function saveEndpoint(url){ localStorage.setItem(endpointKey, url || ''); }
                function loadEndpoint(){ return localStorage.getItem(endpointKey) || ''; }
                // initialize endpoint input
                if (aiEndpointInput) aiEndpointInput.value = loadEndpoint();
                if (saveEndpointBtn && aiEndpointInput) saveEndpointBtn.addEventListener('click', ()=>{ saveEndpoint(aiEndpointInput.value.trim()); alert('تم حفظ نقطة النهاية محلياً. تأكد من أن الخادم يحتوي مفتاح API ولا تكشفه في المتصفح.'); });

                // utility: render a message into chat
                function appendMessage({role='assistant', text='', sources=[]}){
                    const container = document.createElement('div');
                    container.className = role === 'user' ? 'msg user' : 'msg assistant';
                    container.innerHTML = `<div class="content">${escapeHtml(text)}</div>`;
                    if (sources && sources.length){
                        const src = document.createElement('div');
                        src.className = 'sources';
                        src.textContent = 'المصادر: ' + sources.join(' • ');
                        container.appendChild(src);
                    }
                    chatMessages.appendChild(container);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                    return container;
                }

                // escape basic HTML to avoid injection
                function escapeHtml(str){
                    return String(str).replace(/[&<>"']/g, function(m){ return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[m]; });
                }

                // show a single assistant placeholder (returns the element)
                function showAssistantPlaceholder(){
                    // remove existing placeholder if any
                    const existing = chatMessages.querySelector('.msg.assistant.placeholder');
                    if (existing) existing.remove();
                    const el = document.createElement('div');
                    el.className = 'msg assistant placeholder';
                    el.innerHTML = '<div class="content"><span class="loader-dot"></span><span class="loader-dot"></span><span class="loader-dot"></span> جاري التفكير...</div>';
                    chatMessages.appendChild(el);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                    return el;
                }

                function replaceAssistantPlaceholder(text, sources){
                    const ph = chatMessages.querySelector('.msg.assistant.placeholder');
                    if (ph) ph.remove();
                    return appendMessage({role:'assistant', text, sources});
                }

                // Retrieval: KB then site
                function findInKB(question){
                    const kb = loadKB();
                    const normQ = question.replace(/\s+/g,'').toLowerCase();
                    // exact or substring
                    for (const k of Object.keys(kb)){
                        try{
                            const normK = k.replace(/\s+/g,'').toLowerCase();
                            if (normK === normQ || normQ.includes(normK) || normK.includes(normQ)) return {answer: kb[k], source: 'KB'};
                        }catch(e){}
                    }
                    return null;
                }

                function findInSite(question){
                    const text = document.body.innerText || '';
                    const qWords = question.split(/\s+/).slice(0,6).join(' ');
                    let idx = text.indexOf(qWords);
                    if (idx>-1){
                        const start = Math.max(0, idx-120);
                        const snippet = text.substring(start, Math.min(text.length, idx+300)).trim();
                        return {answer: snippet, source: 'الموقع'};
                    }
                    // fallback: keyword sentences
                    const kws = question.split(/\s+/).slice(0,3);
                    for (const kw of kws){
                        const pos = text.indexOf(kw);
                        if (pos>-1){
                            const start = Math.max(0, pos-120);
                            const snippet = text.substring(start, Math.min(text.length, pos+300)).trim();
                            return {answer: snippet, source: 'الموقع'};
                        }
                    }
                    return null;
                }

                // optional remote call: server should accept JSON { question, context } and return { answer }
                async function callRemoteAI(question, contextText){
                    const endpoint = loadEndpoint();
                    if (!endpoint) return null;
                    try{
                        const res = await fetch(endpoint, {
                            method: 'POST',
                            headers: {'Content-Type':'application/json'},
                            body: JSON.stringify({ question, context: contextText })
                        });
                        if (!res.ok) throw new Error('Server returned ' + res.status);
                        const data = await res.json();
                        if (data && data.answer) return {answer: data.answer, source: 'نموذج'};
                    }catch(e){ console.warn('AI endpoint error', e); }
                    return null;
                }

                // Chat submit
                if (qaSubmit && qaInput){
                    qaSubmit.addEventListener('click', async ()=>{
                        const q = qaInput.value && qaInput.value.trim();
                        if (!q) return;
                        appendMessage({role:'user', text:q});
                        const placeholder = showAssistantPlaceholder();

                        // first: KB
                        const kbHit = findInKB(q);
                        if (kbHit){
                            replaceAssistantPlaceholder(kbHit.answer, [kbHit.source]);
                            return;
                        }

                        // second: site (clean, user-friendly summary + source)
                        const siteHit = findInSite(q);
                        if (siteHit){
                            const endpoint = loadEndpoint();
                            if (endpoint){
                                const aiRes = await callRemoteAI(q, siteHit.answer);
                                if (aiRes){
                                    replaceAssistantPlaceholder(aiRes.answer, [siteHit.source, aiRes.source]);
                                    return;
                                }
                            }
                            // create a short, clean Arabic summary from the snippet
                            try {
                                const short = summarizeText(siteHit.answer, 2).trim();
                                const formatted = (short ? short : siteHit.answer) + '\n\nالمصدر: الموقع';
                                replaceAssistantPlaceholder(formatted, [siteHit.source]);
                            } catch(e){
                                replaceAssistantPlaceholder(siteHit.answer, [siteHit.source]);
                            }
                            return;
                        }

                        // third: fallback to remote AI if available
                        const endpoint = loadEndpoint();
                        if (endpoint){
                            const aiRes = await callRemoteAI(q, '');
                            if (aiRes){
                                replaceAssistantPlaceholder(aiRes.answer, [aiRes.source]);
                                return;
                            }
                        }

                        // last resort: friendly fallback with next-step suggestion
                        replaceAssistantPlaceholder('لم أجد إجابة مباشرة في بياناتك أو في محتوى الموقع. يمكنك:\n1) إضافة إجابة مخصصة الآن عبر زر "أضف إجابة" (للإجابة القادمة)،\n2) أو السماح لي بتجربة توليد إجابة أعمق باستخدام نموذج خارجي إذا قمت بتوصيل نقطة نهاية خادم في الإعدادات.', []);
                    });
                }

                // add-answer quick flow (store to KB) with optional keywords
                if (addAnswerBtn && qaInput){
                    addAnswerBtn.addEventListener('click', ()=>{
                        const q = qaInput.value && qaInput.value.trim();
                        if (!q){ alert('الرجاء كتابة السؤال أولا'); return; }
                        const ans = prompt('أضف الإجابة التي تريد أن يتعلمها المساعد لهذا السؤال:');
                        if (!ans || !ans.trim()) return;
                        let kws = prompt('اكتب كلمات مفتاحية مفصولة بفواصل (اختياري)، أو اتركها لاقتراح تلقائي:');
                        let kwList = [];
                        if (kws && kws.trim()) kwList = kws.split(',').map(s=>s.trim()).filter(Boolean);
                        else kwList = extractKeywordsFromQuestion(q);
                        const kb = loadKB(); kb[q] = { answer: ans.trim(), keywords: kwList }; saveKB(kb);
                        alert('تمت الإضافة. المساعد سيستخدم هذه الإجابة لاحقاً.');
                    });
                }

                if (showKbBtn){
                    showKbBtn.addEventListener('click', ()=>{
                        const kb = loadKB();
                        const keys = Object.keys(kb);
                        if (!keys.length){ alert('لا توجد إجابات محفوظة.'); return; }
                        let idx = 0;
                        function editNext(){
                            if (idx >= keys.length) return alert('انتهى التحرير.');
                            const k = keys[idx];
                            const curEntry = kb[k];
                            const curAns = curEntry && curEntry.answer ? curEntry.answer : '';
                            const curKws = (curEntry && curEntry.keywords) ? curEntry.keywords.join(', ') : '';
                            const updated = prompt(`سؤال:\n${k}\n\nالإجابة الحالية:\n${curAns}\n\nكلمات مفتاحية:\n${curKws}\n\nضع الإجابة الجديدة أو اضغط إلغاء للحفاظ عليها`);
                            if (updated === null){
                                const kwUpdated = prompt('ضع كلمات مفتاحية جديدة مفصولة بفواصل (إترك فارغاً للحفاظ):', curKws);
                                if (kwUpdated !== null && kwUpdated.trim()) { curEntry.keywords = kwUpdated.split(',').map(s=>s.trim()).filter(Boolean); saveKB(kb); }
                                idx++; editNext(); return;
                            }
                            curEntry.answer = updated.trim();
                            const kwAsk = prompt('ضع كلمات مفتاحية جديدة مفصولة بفواصل (اختياري):', curKws);
                            if (kwAsk !== null && kwAsk.trim()) curEntry.keywords = kwAsk.split(',').map(s=>s.trim()).filter(Boolean);
                            kb[k] = curEntry; idx++; editNext();
                        }
                        editNext();
                        saveKB(kb);
                    });
                }

                // ensure chat scroll exists
                if (!chatMessages) {
                    console.warn('chat-messages container not found');
                }
            } catch (err) { console.error(err); }

            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            if (mobileMenuButton && mobileMenu) {
                mobileMenuButton.addEventListener('click', () => { mobileMenu.classList.toggle('hidden'); });
                document.querySelectorAll('#mobile-menu a').forEach(link => { link.addEventListener('click', () => { mobileMenu.classList.add('hidden'); }); });
            }
        });

        // --- AI assistant training & QA logic ---
        (function(){
            // Admin toggle: set to true ONLY if you want the training/admin controls to appear.
            // This is a code-level switch: edit this file and change to true, then deploy.
            // Note: keeping this false hides and disables the admin controls for regular visitors.
            const ADMIN_ENABLED = false;
            const QUESTIONS = [
                'ما الفرق بين الاختبار المحوسب والورقي؟',
                'كيف وأسجل في اختبار القدرات؟',
                'ما هي أفضل المصادر للمذاكرة؟',
                'ماذا أحضر يوم الاختبار؟',
                'كم عدد المحاولات المتاحة؟',
                'كيف أحسب النسبة الموزونة؟',
                'متى تفتح فترات التسجيل؟',
                'ما استراتيجية الوقت في الاختبار؟',
                'كيف أتعامل مع استيعاب المقروء؟',
                'ما هي أهم الأخطاء التي يجب تجنبها؟',
                'هل توجد نماذج محوسب؟ أين أجدها؟',
                'ما الفرق بين الأسئلة السهلة والصعبة؟',
                'كيف أراجع قبل الاختبار بأسبوع؟',
                'ما هي رسوم الاختبار؟',
                'هل يمكن تغيير موعد الاختبار؟',
                'أين أجد مواعيد ومراكز الاختبار؟',
                'هل يوجد وقت مخصص للراحة أثناء الاختبار؟',
                'كيف أحسب درجاتي بعد الاختبار؟',
                'ما النصيحة للتركيز أثناء الاختبار؟',
                'هل النتائج تظهر سريعا؟'
            ];

            function kbKey() { return 'qudratksa_kb_v1'; }
            function loadKB() { try { return JSON.parse(localStorage.getItem(kbKey()) || '{}'); } catch(e){ return {}; } }
            function saveKB(kb){ localStorage.setItem(kbKey(), JSON.stringify(kb)); }
            function clearKB(){ localStorage.removeItem(kbKey()); }

            // Populate the training questions in the modal
            const trainingModal = document.getElementById('training-modal');
            const trainingQuestionsDiv = document.getElementById('training-questions');
            if (trainingQuestionsDiv) {
                trainingQuestionsDiv.innerHTML = QUESTIONS.map((q,i) => `
                    <div class="border p-3 rounded-md">
                        <label class="font-semibold">${i+1}. ${q}</label>
                        <textarea data-q-index="${i}" class="w-full mt-2 p-2 border rounded-md" rows="2" placeholder="أضف إجابتك أو اتركها فارغة"></textarea>
                    </div>
                `).join('');
            }

            // Open/close modal
            const openBtn = document.getElementById('open-training');
            const closeBtn = document.getElementById('close-training');
            const skipBtn = document.getElementById('skip-training');
            const trainingForm = document.getElementById('training-form');
            const clearBtn = document.getElementById('clear-training');

            // Admin code-level toggle: reveal admin-only elements only when enabled in code
            if (ADMIN_ENABLED) {
                // show admin-only elements
                document.querySelectorAll('.admin-only').forEach(el => {
                    el.style.display = '';
                    el.removeAttribute('aria-hidden');
                    if (el.tagName === 'BUTTON') el.disabled = false;
                });
                // enable training textareas
                if (trainingForm) trainingForm.querySelectorAll('textarea[data-q-index]').forEach(t=>t.removeAttribute('disabled'));
            } else {
                // hide/disable admin-only controls for visitors
                document.querySelectorAll('.admin-only').forEach(el => {
                    el.style.display = 'none';
                    el.setAttribute('aria-hidden','true');
                    if (el.tagName === 'BUTTON') el.disabled = true;
                });
                if (trainingForm) trainingForm.querySelectorAll('textarea[data-q-index]').forEach(t=>t.setAttribute('disabled','disabled'));
                // ensure the training modal is not visible
                if (trainingModal) { trainingModal.classList.add('hidden'); trainingModal.classList.remove('flex'); }
            }

            if (openBtn && trainingModal) openBtn.addEventListener('click', () => { trainingModal.classList.remove('hidden'); trainingModal.classList.add('flex'); });
            if (closeBtn && trainingModal) closeBtn.addEventListener('click', () => { trainingModal.classList.add('hidden'); trainingModal.classList.remove('flex'); });
            if (skipBtn && trainingModal) skipBtn.addEventListener('click', () => { trainingModal.classList.add('hidden'); trainingModal.classList.remove('flex'); });
            if (clearBtn) clearBtn.addEventListener('click', () => { if (confirm('مسح جميع بيانات المساعد؟')){ clearKB(); alert('تم المسح'); } });

            if (trainingForm) trainingForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const kb = loadKB();
                const areas = trainingForm.querySelectorAll('textarea[data-q-index]');
                areas.forEach(area => {
                    const idx = area.getAttribute('data-q-index');
                    const q = QUESTIONS[idx];
                    const ans = area.value && area.value.trim();
                    if (ans) kb[q] = { answer: ans, keywords: extractKeywordsFromQuestion(q) };
                });
                saveKB(kb);
                trainingModal.classList.add('hidden'); trainingModal.classList.remove('flex');
                alert('تم حفظ إجاباتك. المساعد الآن يستخدم هذه المعلومات عند الإجابة.');
            });

            // QA behavior: search KB first, then the page text (document.body.innerText)
            function findInKB(question){
                const kb = loadKB();
                // simple exact or substring match
                for (const q in kb){
                    try{
                        const norm = q.replace(/\s+/g,'').toLowerCase();
                        const normQ = question.replace(/\s+/g,'').toLowerCase();
                        if (normQ.includes(norm) || norm.includes(normQ) || normQ === norm) return kb[q];
                    }catch(e){}
                }
                return null;
            }

            function findInSite(question){
                try{
                    const text = document.body.innerText || '';
                    const q = question.split(/\s+/).slice(0,6).join(' ');
                    const idx = text.indexOf(q);
                    if (idx !== -1) {
                        // return surrounding snippet
                        const start = Math.max(0, idx-120);
                        return text.substring(start, Math.min(text.length, idx+300)).trim();
                    }
                    // fallback: search sentence containing keywords
                    const keywords = question.split(/\s+/).slice(0,3);
                    for (const kw of keywords){
                        const pos = text.indexOf(kw);
                        if (pos>-1) return text.substring(Math.max(0,pos-120), Math.min(text.length,pos+300)).trim();
                    }
                }catch(e){}
                return null;
            }

            // QA submit and add-answer
            const qaSubmit = document.getElementById('qa-submit');
            const qaInput = document.getElementById('qa-input');
            const aiResponseContent = document.getElementById('ai-response-content');
            const addAnswerBtn = document.getElementById('add-answer');

            if (qaSubmit && qaInput && aiResponseContent){
                qaSubmit.addEventListener('click', () => {
                    const q = qaInput.value && qaInput.value.trim();
                    if (!q){ aiResponseContent.textContent = 'الرجاء كتابة السؤال أولاً.'; return; }
                    aiResponseContent.textContent = '';
                    // 1) KB
                    const kbAns = findInKB(q);
                    if (kbAns){ aiResponseContent.textContent = kbAns; return; }
                    // 2) site text
                    const siteAns = findInSite(q);
                    if (siteAns){ aiResponseContent.textContent = siteAns; return; }
                    aiResponseContent.textContent = 'لم أجد إجابة في بياناتك أو في محتوى الموقع. يمكنك إضافة إجابة مخصصة بالضغط على "أضف إجابة".';
                });
            }

            if (addAnswerBtn && qaInput){
                addAnswerBtn.addEventListener('click', ()=>{
                    const q = qaInput.value && qaInput.value.trim();
                    if (!q){ alert('الرجاء كتابة السؤال أولا'); return; }
                    const ans = prompt('أضف الإجابة التي تريد أن يتعلمها المساعد لهذا السؤال:');
                    if (ans && ans.trim()){
                        const kb = loadKB(); kb[q] = ans.trim(); saveKB(kb);
                        alert('تمت الإضافة. المساعد سيستخدم هذه الإجابة لاحقاً.');
                    }
                });
            }
        })();

        function calculateWeightedScore() {
            const hsPercent = parseFloat(document.getElementById('hs-percent').value) || 0;
            const quPercent = parseFloat(document.getElementById('qu-percent').value) || 0;
            const taPercent = parseFloat(document.getElementById('ta-percent').value) || 0;
            const hsScore = parseFloat(document.getElementById('hs-score').value) || 0;
            const quScore = parseFloat(document.getElementById('qu-score').value) || 0;
            const taScore = parseFloat(document.getElementById('ta-score').value) || 0;
            const totalPercent = hsPercent + quPercent + taPercent;
            const percentWarning = document.getElementById('percent-warning');
            if (percentWarning) {
                if (Math.round(totalPercent) !== 100 && totalPercent > 0) {
                    percentWarning.classList.remove('hidden');
                } else {
                    percentWarning.classList.add('hidden');
                }
            }
            const weightedScore = (hsScore * hsPercent / 100) + (quScore * quPercent / 100) + (taScore * taPercent / 100);
            const resultEl = document.getElementById('result');
            if (resultEl) resultEl.textContent = weightedScore.toFixed(2);
        }

        function filterResources(filter, clickedButton) {
            const quantResourceCards = document.querySelectorAll('#quantitative-resources-grid .resource-card');
            const quantFilterButtons = document.querySelectorAll('#resources .filter-button');
            quantFilterButtons.forEach(button => button.classList.remove('active'));
            if (clickedButton) clickedButton.classList.add('active');
            quantResourceCards.forEach(card => {
                const category = card.dataset.category;
                card.style.display = (filter === 'all' || category === filter) ? 'flex' : 'none';
            });
        }

        function switchAITab(tabName) {
            const aiTabs = {
                qa: document.getElementById('content-qa'),
                explain: document.getElementById('content-explain'),
                generate: document.getElementById('content-generate')
            };
            const aiTabButtons = document.querySelectorAll('.ai-tab-button');
            Object.values(aiTabs).forEach(tab => { if (tab) tab.classList.add('hidden'); });
            aiTabButtons.forEach(btn => btn.classList.remove('active'));
            if (aiTabs[tabName]) aiTabs[tabName].classList.remove('hidden');
            const activeBtn = document.getElementById('tab-' + tabName);
            if (activeBtn) activeBtn.classList.add('active');
        }

        function toggleNimrDetails(button) {
            const detailsDiv = button.nextElementSibling;
            if (!detailsDiv) return;
            const isHidden = detailsDiv.classList.contains('hidden');

            if (isHidden) {
                detailsDiv.classList.remove('hidden');
                button.innerHTML = 'إخفاء التفاصيل <i data-lucide="arrow-up" class="inline-block w-4 h-4 transition-transform"></i>';
            } else {
                detailsDiv.classList.add('hidden');
                button.innerHTML = 'اقرأ التفاصيل الكاملة <i data-lucide="arrow-down" class="inline-block w-4 h-4 transition-transform"></i>';
            }
            if (typeof lucide !== 'undefined' && lucide.createIcons) lucide.createIcons();
        }
    </script>
    </body>
</html>


